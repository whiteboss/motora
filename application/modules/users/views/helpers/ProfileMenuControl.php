<?php/** *  * Помошник вида: шапка профиля компании */class Users_View_Helper_ProfileMenuControl extends Zend_View_Helper_Abstract{    public function ProfileMenuControl()    {        $friend = 'Amigos';        $user = NULL;                $me = false;                $tabs = array();        $tabs['profile']['name'] = 'Perfil';        $tabs['profile']['link'] = $this->view->url(array('userId' => $this->view->user->id), 'profile');;        $auth = Zend_Auth::getInstance();        if ($auth->hasIdentity()) {                         $user = $auth->getIdentity();            if ($user->id == $this->view->user->id) {                $friendRequestCount = count($this->view->user->getFriendRequests());                if ($friendRequestCount > 0) {                    $friend .= ' <b>+'.$friendRequestCount.'</b>';                }                $me = true;            }            // ТАБЫ            $message = '';                         if ( ($me) || (!$me && count($this->view->user->getFriends(1, true)) > 0)) {                            $tabs['friends']['name'] = '' . $friend . '';                $tabs['friends']['link'] = $this->view->url(array('userId' => $this->view->user->id), 'userfriends');            }                        if ($me) {                $message = 'Mensajes';                                $table = new Users_Model_Table_Messages();                $messageCount = $table->getCountMessages(array('userId' => $this->view->user->id, 'messageType' => '3'))->current()->messageCount;                if ($messageCount > 0) {                    $message .= ' <b> +'.$messageCount.'</b>';                }                $tabs['messages']['name'] = $message;                $tabs['messages']['link'] = $this->view->url(array(), 'usermessages');                //$tabs["feeds"] = 'Suscripciónes';            }        }                if ( ($me) || (!$me && count($this->view->user->getPosts(true)) > 0) ) {            $tabs['posts']['name'] = 'Blog';            $tabs['posts']['link'] = $this->view->url(array('userId' => $this->view->user->id), 'userposts');        }                if ( ($me) || (!$me && count($this->view->user->getEvents(true)) > 0) ) {             $tabs['events']['name'] = 'Eventos';            $tabs['events']['link'] = $this->view->url(array('userId' => $this->view->user->id), 'userevents');        }                if ( ($me) || (!$me && count($this->view->user->getMusics(true)) > 0) ) {             $tabs['musics']['name'] = 'Música';            $tabs['musics']['link'] = $this->view->url(array('userId' => $this->view->user->id), 'usermusics');        }                if ( ($me) || (!$me && count($this->view->user->getVideos(true)) > 0) ) {             $tabs['videos']['name'] = 'Video';            $tabs['videos']['link'] = $this->view->url(array('userId' => $this->view->user->id), 'uservideos');        }                if ( ($me) || (!$me && count($this->view->user->getPhotoReports(true)) > 0) ) {            $tabs['galleries']['name'] = 'Fotografías';            $tabs['galleries']['link'] = $this->view->url(array('userId' => $this->view->user->id), 'usergalleries');                    }                if ( ($me) || (!$me && count($this->view->user->getCompanies(true)) > 0) ) {            $tabs['companies']['name'] = 'Lugares';            $tabs['companies']['link'] = $this->view->url(array('userId' => $this->view->user->id), 'usercompanies');                    }        //        $resume = $this->view->user->getResume();//        if ( ($me) || (!$me && !is_null($resume) && $resume->is_visible == 1) )        //            $tabs['resume'] = 'CV';        if ($auth->hasIdentity()) {            if (!is_null($user) && $user->id == $this->view->user->id) {                $tabs['options']['name'] = "Ajustes";                $tabs['options']['link'] = $this->view->url(array(), 'options');            }        }        $list = array();        foreach ($tabs as $name => $title) {                if ($this->view->active == $name)                    $list[] = '<li class="bor4"><a class="aktiv bor4 black lnone" href="' . $title['link'] .'"><img class="IblogM" src="/zeta/0.png" width="33" height="33" alt=""><b>' . $title['name'] . '</b></a></li>';                else                    $list[] = '<li><a class="purple bor4" href="' . $title['link'] . '"><img src="/zeta/0.png" width="33" height="1" alt="NOBG">' . $title['name'] . '</a></li>';        }        $photopart = '';        $output = '            <ul class="QblogM QblogM3 Q80 f14 pull-left mb15">                ' . implode("\n", $list) . '            </ul>            ';        return $output;    }}